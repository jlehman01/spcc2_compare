---
title: "Compare SPCC Rasters: 1.0 & 1.2"
output:
  html_document:
    df_print: paged
editor_options:
  chunk_output_type: console
---


```{r, include = FALSE, echo = FALSE}

knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)

require(tidyverse)
require(sf)
library(arcgisbinding)
library(raster)
library(tmap)
library(kableExtra)

options(width = 2000)

tmap_mode("view")

arc.check_product()

options(scipen=999)
```


```{r}
#SPCC colors

spcc_palette <- c("#267300", '#D7C29E', "#FFFFD4", "#F5EE1C", "#FFBEBE", "#E60000", "#730000", "#89CD66", "#828282", "#AA66CD", "#004C73", "#00C5FF")

length(spcc_palette)
```

Note: This version of SPC 1.2 includes the following updated layers from SPCC 1.1:

* Intersection Density (Weighted by 1-Mile Centrality, based on OSMNX)
* Diversity

## Legend

![SPCC Legend](K:\\Projects\\D4_CSHnetwork\\Graphics\\legend.PNG)

## SPCC 1.0 and SPCC 1.2 Mapping

```{r}

spcc10 <- as.raster(arc.raster(arc.open('K:\\Projects\\D4_CSHnetwork\\Features\\LU\\SPCC\\Outputs\\Existing\\PBC\\Version4k.gdb\\DetAnalyticLU_FINAL')))

spcc12 <- as.raster(arc.raster(arc.open('K:\\Projects\\D4_CSHnetwork\\Features\\LU\\SPCC_20\\spcc_v2_10\\outputs\\existing\\Version_2_1_0.gdb\\DetAnalyticLU_FINAL_reclass')))

crs(spcc10) <- crs(spcc12)

diff <- overlay(spcc10, spcc12, fun=function(a,b) return(a==b))

map1 <- tm_shape(spcc10) + tm_raster(style = "cat", palette = spcc_palette, title = "SPCC 1.0") + tm_basemap("Esri.WorldImagery")

map2 <- tm_shape(spcc12) + tm_raster(style = "cat", palette = spcc_palette, title = "SPCC 1.2") + tm_basemap("Esri.WorldImagery")

map3 <- tm_shape(diff) + tm_raster(style = "cat", palette = 'viridis', title = "Difference") + tm_basemap("Esri.WorldImagery")

tmap_arrange(map1, map2, map3, ncol = 1, sync = TRUE)

```

## Cross tabulation of SPCC 1.0 versus SPCC 1.2

```{r}
crosstab(spcc10, spcc12) %>% kbl() %>% 
  kable_paper("hover", full_width = F) %>% 
  column_spec(1, bold = T, border_right = T)
```


